---
title: 操作系统的运行环境
---



# 处理器运行模式

## 用户态（目态）

### 非特权指令

## 核心态（管态、内核态）

### 特权指令

## 时钟管理

## 中断机制

## 原语

### 特征

- 处于操作系统的底层，是最接近硬件的部分
- 运行具有原子性，操作只能一气呵成
- 运行时间较短，且调用频繁
- 系统控制的数据结构及处理

# 中断和异常的概念

## 定义
### 外部中断（硬件中断）

#### Remind

- > 也称外中断，指来自CPU执行指令外部的事件，也就是硬件中断

#### 可屏蔽中断（INTR）

#### 不可屏蔽中断（NMI）

### 内部异常：

#### Remind

- > 也称内中断，指来自CPU执行指令内部的事件，==不能被屏蔽==

#### 软件中断（也是需要依靠==硬件实现==）

##### 故障（Fault）

##### 自陷（Trap）

#### 硬件中断

——终止（Abort）

## 作用

- 让操作系统内核强行夺回CPU的控制权
- 使CPU从用户态变为内核态

## 中断机制的基本实现原理（中断和异常的处理过程）
### 检查中断信号

#### 内中断

- > CPU在执行指令时会检查是否有异常发生

#### 外中断

- > 每个指令周期末尾，CPU都会检查是否有外中断信号需要处理

### 找到相应的中断处理程序

- > 通过“中断向量表”实现

# 系统调用

## 定义

- > 操作系统对应用程序/程序员提供的接口

## 功能
### 设备管理

### 文件管理

### 进程控制

### 进程通信

### 内存管理

## 过程
### 传参

### 陷入指令/Trap/访管指令（运行在==用户态==）

- > 用户态-\>内核态，由==硬件实现==

- 由操作系统内核程序处理系统调用请求（执行）

- 返回应用程序

## 与库函数的区别

- 库函数由编程语言提供，可以有对系统调用的封装，也可以不吸收系统调用。

## Tip

- 凡是==与共享资源有关的操作== ，都必须通过系统调用的方式向操作系统内核提出服务请求，保证系统的==稳定性==和==安全性==。系统调用由==内核程序==完成，所以执行在==内核态==